{"ast":null,"code":"var _jsxFileName = \"/home/umar/Desktop/Web development/redux-book-shelf/src/lib/auth.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$(),\n    _s3 = $RefreshSig$(),\n    _s4 = $RefreshSig$();\n\nimport React, { useState, useEffect, useContext, createContext } from \"react\";\nimport { Route } from \"react-router\";\nimport Login from \"../pages/Login\";\nimport firebase from \"./firebase\";\nimport Preloader from '../components/Preloader';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst authContext = /*#__PURE__*/createContext();\nexport function AuthProvider({\n  children\n}) {\n  _s();\n\n  const auth = useProvideAuth();\n  return /*#__PURE__*/_jsxDEV(authContext.Provider, {\n    value: auth,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 10,\n    columnNumber: 10\n  }, this);\n}\n\n_s(AuthProvider, \"XNU4Jn8u4aVzJknlKOHFJq03xMo=\", false, function () {\n  return [useProvideAuth];\n});\n\n_c = AuthProvider;\nexport const useAuth = () => {\n  _s2();\n\n  return useContext(authContext);\n};\n\n_s2(useAuth, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\nexport const PrivateRoute = ({\n  component: Component,\n  handleChildFunc,\n  ...rest\n}) => {\n  _s3();\n\n  const {\n    user,\n    loginStatus\n  } = useAuth();\n  return /*#__PURE__*/_jsxDEV(Route, { ...rest,\n    render: props => loginStatus.status === \"pending\" ? /*#__PURE__*/_jsxDEV(Preloader, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 28,\n      columnNumber: 11\n    }, this) : user ? /*#__PURE__*/_jsxDEV(Component, { ...props\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 30,\n      columnNumber: 11\n    }, this) : /*#__PURE__*/_jsxDEV(Login, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 32,\n      columnNumber: 11\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 24,\n    columnNumber: 5\n  }, this);\n};\n\n_s3(PrivateRoute, \"pry+Ji2HxiklVujb4/2eY3euuhk=\", false, function () {\n  return [useAuth];\n});\n\n_c2 = PrivateRoute;\n\nfunction useProvideAuth() {\n  _s4();\n\n  const [user, setUser] = useState();\n  const [loginStatus, setLoginStatus] = useState({\n    status: \"idle\",\n    error: null\n  });\n\n  const formatUser = user => ({\n    email: user.email,\n    name: user.displayName,\n    provider: user.providerData[0].providerId,\n    photoUrl: user.photoURL,\n    uid: user.uid\n  });\n\n  const signInWithGoogle = () => {\n    return firebase.auth().signInWithPopup(new firebase.auth.GoogleAuthProvider()).then(response => {\n      const formattedUser = formatUser(response.user);\n      setUser(formattedUser);\n      setLoginStatus({\n        status: \"resolved\",\n        error: null\n      });\n      return formattedUser;\n    }).catch(err => {\n      setUser(null);\n      setLoginStatus({\n        status: \"resolved\",\n        error: err.message\n      });\n    });\n  };\n\n  const signOut = () => {\n    return firebase.auth().signOut().then(() => {\n      setUser(null);\n      setLoginStatus({\n        status: \"idle\",\n        error: null\n      });\n    });\n  };\n\n  useEffect(() => {\n    setLoginStatus({\n      status: \"pending\",\n      error: null\n    });\n    const unsubscribe = firebase.auth().onAuthStateChanged(user => {\n      if (user) {\n        const formattedUser = formatUser(user);\n        setUser(formattedUser);\n        setLoginStatus({\n          status: \"resolved\",\n          error: null\n        });\n      } else {\n        setLoginStatus({\n          status: \"idle\",\n          error: null\n        });\n        setUser(false);\n      }\n    });\n    return () => unsubscribe();\n  }, []);\n  return {\n    user,\n    loginStatus,\n    signInWithGoogle,\n    signOut\n  };\n}\n\n_s4(useProvideAuth, \"xqcqgYmSbN9tzXqrcReBeAid8Dg=\");\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"AuthProvider\");\n$RefreshReg$(_c2, \"PrivateRoute\");","map":{"version":3,"sources":["/home/umar/Desktop/Web development/redux-book-shelf/src/lib/auth.js"],"names":["React","useState","useEffect","useContext","createContext","Route","Login","firebase","Preloader","authContext","AuthProvider","children","auth","useProvideAuth","useAuth","PrivateRoute","component","Component","handleChildFunc","rest","user","loginStatus","props","status","setUser","setLoginStatus","error","formatUser","email","name","displayName","provider","providerData","providerId","photoUrl","photoURL","uid","signInWithGoogle","signInWithPopup","GoogleAuthProvider","then","response","formattedUser","catch","err","message","signOut","unsubscribe","onAuthStateChanged"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext, createContext } from \"react\";\nimport { Route } from \"react-router\";\nimport Login from \"../pages/Login\";\nimport firebase from \"./firebase\";\nimport Preloader from '../components/Preloader'\nconst authContext = createContext();\n\nexport function AuthProvider({ children }) {\n  const auth = useProvideAuth();\n  return <authContext.Provider value={auth}>{children}</authContext.Provider>;\n}\n\nexport const useAuth = () => {\n  return useContext(authContext);\n};\n\nexport const PrivateRoute = ({\n  component: Component,\n  handleChildFunc,\n  ...rest\n}) => {\n  const { user, loginStatus } = useAuth();\n  return (\n    <Route\n      {...rest}\n      render={(props) =>\n        loginStatus.status === \"pending\" ? (\n          <Preloader />\n        ) : user ? (\n          <Component {...props} />\n        ) : (\n          <Login />\n        )\n      }\n    />\n  );\n};\n\nfunction useProvideAuth() {\n  const [user, setUser] = useState();\n  const [loginStatus, setLoginStatus] = useState({\n    status: \"idle\",\n    error: null,\n  });\n\n  const formatUser = (user) => ({\n    email: user.email,\n    name: user.displayName,\n    provider: user.providerData[0].providerId,\n    photoUrl: user.photoURL,\n    uid: user.uid,\n  });\n\n  const signInWithGoogle = () => {\n    return firebase\n      .auth()\n      .signInWithPopup(new firebase.auth.GoogleAuthProvider())\n      .then((response) => {\n        const formattedUser = formatUser(response.user);\n        setUser(formattedUser);\n        setLoginStatus({ status: \"resolved\", error: null });\n        return formattedUser;\n      })\n      .catch((err) => {\n        setUser(null);\n        setLoginStatus({ status: \"resolved\", error: err.message });\n      });\n  };\n\n  const signOut = () => {\n    return firebase\n      .auth()\n      .signOut()\n      .then(() => {\n        setUser(null);\n        setLoginStatus({ status: \"idle\", error: null });\n      });\n  };\n\n  useEffect(() => {\n    setLoginStatus({ status: \"pending\", error: null });\n    const unsubscribe = firebase.auth().onAuthStateChanged((user) => {\n      if (user) {\n        const formattedUser = formatUser(user);\n        setUser(formattedUser);\n        setLoginStatus({ status: \"resolved\", error: null });\n      } else {\n        setLoginStatus({ status: \"idle\", error: null });\n        setUser(false);\n      }\n    });\n\n    return () => unsubscribe();\n  }, []);\n\n  return {\n    user,\n    loginStatus,\n    signInWithGoogle,\n    signOut,\n  };\n}\n"]},"metadata":{},"sourceType":"module"}